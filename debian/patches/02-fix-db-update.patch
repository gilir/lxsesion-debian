From 04a5a75ba10adeee261dc46a78314a08cfe093f3 Mon Sep 17 00:00:00 2001
From: Julien Lavergne <julien.lavergne@gmail.com>
Date: Mon, 20 Oct 2014 00:17:36 +0200
Subject: [PATCH] Correctly connect and emit signals for lxsession-db (sould really fix #692)

---
 lxsession-db/desktop-files-backend.vala | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)

diff --git a/lxsession-db/desktop-files-backend.vala b/lxsession-db/desktop-files-backend.vala
index be9622b..1e538e4 100644
--- a/lxsession-db/desktop-files-backend.vala
+++ b/lxsession-db/desktop-files-backend.vala
@@ -186,7 +186,7 @@ namespace Lxsession
 
         public void on_finish_scanning_installed()
         {
-            message("Signal finish scanning with mode: %s",this.mode);
+            message("Signal finish scanning installed with mode: %s",this.mode);
             if (this.mode == "display")
             {
                 print_values_installed ();
@@ -206,7 +206,7 @@ namespace Lxsession
 
         public void on_finish_scanning_available()
         {
-            message("Signal finish scanning with mode: %s",this.mode);
+            message("Signal finish scanning available with mode: %s",this.mode);
             if (this.mode == "display")
             {
                 global_db.print_values_available ();
@@ -263,6 +263,7 @@ namespace Lxsession
                     else
                     {
                         message ("%s doesn't exist. Pass", folder);
+                        finish_scanning_available();
                     }
                 }
             }
@@ -274,11 +275,11 @@ namespace Lxsession
 
         public void update ()
         {
-            update_installed();
             finish_scanning_installed.connect(on_finish_scanning_installed);
+            finish_scanning_available.connect(on_finish_scanning_available);
 
+            update_installed();
             update_available();
-            finish_scanning_available.connect(on_finish_scanning_available);
         }
 
         private async void list_desktop_files (string path, string mode)
-- 
2.1.1

